{{ define "title"}}Overpower Play Game Page{{end}}
{{ define "css"}}overpower{{end}}
{{define "body"}}
{{ $g := .game }}
{{ $f := .fac }}
{{ $fNames := .fNames }}
{{ $center := .mapview.Center }}

<div class="mapbox">
<form id="mapform" action="" method="post" class="noblock">
<input type="hidden" name="turn" value="{{ $g.Turn }}">
<input type="hidden" name="action" value="mapclick">
</form>
<img id="map" class="map" src="/overpower/img/{{ $g.Gid }}" width=800 height=600 />

Game: [ <a href="/overpower/view/{{ $g.Gid }}">{{ $g.Name }}</a> ] &bull; Faction: {{ $f.Name }} &bull; Turn: {{ $g.Turn }} 
{{ if not $f.Done }}
(In Progress)
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setdone">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="done" value="true">
        <input type="submit" value="Set Turn Complete" class="noblock">
</form>
{{ else }}
(Complete)
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setdone">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="done" value="false">
        <input type="submit" value="Cancel Turn Complete" class="noblock">
</form>
{{ end }}
<hr>
Map Centered on ({{ index $center 0}}, {{ index $center 1 }}):
{{  if .centerpv }}{{ .centerpv.Name }}{{ else }}Empty Space{{ end }}<br>
Zoom {{ .mapview.Zoom }} {{ if .zoomin }}
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="subtype" value="zoom">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="zoom" value="{{ .zoomin }}">
        <input type="submit" value="Zoom In" class="noblock">
</form>
{{ end }}

{{ if .zoomout }}
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="subtype" value="zoom">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="zoom" value="{{ .zoomout }}">
        <input type="submit" value="Zoom Out" class="noblock">
</form>
{{ end }}
 {{ if .bigzoomin }}
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="subtype" value="zoom">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="zoom" value="{{ .bigzoomin }}">
        <input type="submit" value="Big Zoom In" class="noblock">
</form>
{{ end }}
{{ if .bigzoomout }}
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="subtype" value="zoom">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="zoom" value="{{ .bigzoomout }}">
        <input type="submit" value="Big Zoom Out" class="noblock">
</form>
{{ end }}
<hr>

<div class="targetframe">
<div class="rightframe">
        <b>Secondary Target:</b> {{ if .target2.Valid }}
{{ if .targetsSame }} {{ .target2.Coord }} (Same as main target)<br> {{ else }}
        {{ .target2.Coord }}<br>
{{ if .cancenter2 }}
[ <a href="{{ command "recenter"}}/{{ index .target2.Coord 0 }}/{{ index .target2.Coord 1 }}">Center map here</a> ]<br>
{{ end }}
        {{ if .tar2pv }}
        {{ $pl := .tar2pv }}
        {{ $other := .tar1pv }}
        {{ $yours := eq $pl.Controller $f.Fid }}
        {{ $pl.Name }}<br>
        {{ if not $pl.Turn }} No planetary information available.<br> {{ else }}
        {{ if not $yours }}
        Hostile planet: controlled by {{ index $fNames $pl.Controller }}<br>
        Last seen on turn {{ $pl.Turn }}<br>
        Inhabitants: {{ $pl.Inhabitants }} &bull; Resources: {{ $pl.Resources }}<br>
        Ship parts: {{ $pl.Parts }}<br>


        {{ else }}
        {{ $avail := index .availMap $pl.Pid }}
        Your planet<br>
        Inhabitants: {{ $pl.Inhabitants }} &bull; Resources: {{ $pl.Resources }}<br>
        Ship parts: {{ $pl.Parts }} ({{ $avail }} available)<br>
        
        {{ end }} {{ end }}{{ end }}
        

        {{ end }} {{ else }} 
        None<br>
        {{ end }}
</div>
<div class="leftframe">
        <b>Main Target:</b> {{ if .target1.Valid }}
        {{ .target1.Coord }}<br>
{{ if .cancenter1 }}
[ <a href="{{ command "recenter"}}/{{ index .target1.Coord 0 }}/{{ index .target1.Coord 1 }}">Center map here</a> ]<br>
{{ end }}
        {{ if .tar1pv }}
        {{ $pl := .tar1pv }}
        {{ $other := .tar2pv }}
        PLANET STUFF HERE
        {{ end }}


        {{ else }} 
        None<br>
        {{ end }}
</div>
<div class="clearer"></div>
<div class="targetcenter">
{{ if .tarDist }}
        Distance between targets: {{ .tarDist }}<br>
{{ end }}
{{ if .canswap }}
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="subtype" value="swap">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="submit" value="Swap main/secondary targets" class="noblock">
</form>
{{ end }}
</div>
</div>

</div>
<script src="/static/js/overpower.js"></script>
{{ end }}
