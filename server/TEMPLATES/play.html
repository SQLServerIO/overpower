{{ define "title"}}Overpower Play Game Page{{end}}
{{ define "css"}}overpower{{end}}
{{define "body"}}
{{ $g := index . "game" }}
{{ $f := index . "fac" }}
{{ $orders := index . "orders" }}
{{ $availparts := index . "availparts" }}
{{ $names := index . "names" }}
{{ $plNames := index . "plnames" }}
<div class="mapbox">
<img class="map" src="/overpower/img/{{ $g.Gid }}" width=600 height=600 />
Game: [ <a href="/overpower/view/{{ $g.Gid }}">{{ $g.Name }}</a> ] &bull; Faction: {{ $f.Name }} &bull; Turn: {{ $g.Turn }} 
{{ if not $f.Done }}
(In Progress)
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setdone">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="done" value="true">
        <input type="submit" value="Set Turn Complete" class="noblock">
</form>
{{ else }}
(Complete)
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setdone">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="done" value="true">
        <input type="hidden" name="done" value="false">
        <input type="submit" value="Cancel Turn Complete" class="noblock">
</form>
{{ end }}
<br><br>
MAP CONTROLS:<br>
<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        X:<input type="text" name="centerx" width=5 value="{{ index .mapview.Center 0 }}">
        Y:<input type="text" name="centery" width=5 value="{{ index .mapview.Center 1 }}">
        <input type="submit" value="Set Center" class="noblock">
</form>
<br>

<form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setmap">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="text" name="zoom" width=5 value="{{ .mapview.Zoom }}">
        <input type="submit" value="Set Zoom" class="noblock">
</form>
</div>

<hr>
{{ range index . "pvs"}}
<div class="box">
        {{ $polar := .Loc.Polar }}
        {{ .Name }} || Pid: {{ .Pid }} || Grid: {{ .Loc }} ({{ if index $polar 0 }}Sector: {{ .Loc.Sector }} Radius: {{ index $polar 0 }}{{ else }}GALACTIC CENTER{{ end }})<br>
{{ if eq .Controller $f.Fid }}
        YOUR PLANET || Inhabitants: {{ .Inhabitants }}<br>
        Resources: {{ .Resources }} || Ship Parts: {{ .Parts }} (Available: {{ index $availparts .Pid }})<br>
        <hr>
        ORDERS:<br>
        <ul> {{ range index $orders .Pid }}
                <li>
                TARGET: {{ index $plNames .Target }} ({{ .Target }}) || 
                SIZE: {{ .Size }}
                <form action="" method="post" class="noblock">
                <input type="hidden" name="action" value="setorder">
                <input type="hidden" name="turn" value="{{ $g.Turn }}">
                <input type="hidden" name="source" value="{{ .Source }}">
                <input type="hidden" name="target" value="{{ .Target }}">
                <br> CHANGE SIZE (0 to cancel):<input type="text" name="size">
                <input type="submit" value="ALTER CONSTRUCTION" class="noblock">
                </form>

                </li>
                {{ else }}
                <li>NONE</li>
                {{ end }}
        </ul>
        NEW ORDER:<br>
        <form action="" method="post" class="noblock">
        <input type="hidden" name="action" value="setorder">
        <input type="hidden" name="turn" value="{{ $g.Turn }}">
        <input type="hidden" name="source" value="{{ .Pid }}">
        TARGET:<input type="text" name="target">
        SIZE:<input type="text" name="size">
        <input type="submit" value="ORDER SHIP CONSTRUCTION" class="noblock">
        </form>
{{ else }}
        {{ if .Turn }}Last Seen: Turn {{ .Turn }}<br>
        Owner: {{ index $names .Controller }} || Inhabitants: {{ .Inhabitants }}<br>
        Resources: {{ .Resources }} || Ship Parts: {{ .Parts }}<br>
        {{ else }}No planetary information available<br>{{end}}
{{ end }}
</div>
{{ else }}
NO PV FOUND<br>
{{ end }}
<hr>
{{ range .svs }}
SHIPVIEW: {{ . }}<br>
{{ else }}
NO SHIPVIEWS FOUND<br>
{{ end }}
{{ end }}
